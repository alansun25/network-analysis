---
title: "Tables comparing observed network statistics with 95% intervals for bootstrap/jackknife differences and degree sequences at different time points"
author: "Alan Sun"
date: "7/20/2021"
output: 
  pdf_document:
      extra_dependencies: ["makecell"]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(igraph)
library(knitr)
library(kableExtra)
load("env.RData")
```

# Friendship Network

## Transitivity
```{r echo=FALSE}
tbd21 <- tboot_f2 - tboot_f1
tbd32 <- tboot_f3 - tboot_f2
tbd43 <- tboot_f4 - tboot_f3
tbd31 <- tboot_f3 - tboot_f1
tbd42 <- tboot_f4 - tboot_f2
tbd41 <- tboot_f4 - tboot_f1

tjd21 <- tjack_f2 - tjack_f1
tjd32 <- tjack_f3 - tjack_f2
tjd43 <- tjack_f4 - tjack_f3
tjd31 <- tjack_f3 - tjack_f1
tjd42 <- tjack_f4 - tjack_f2
tjd41 <- tjack_f4 - tjack_f1

CItbd21 <- round(quantile(tbd21, c(.025, .975)), 3)
CItjd21 <- round(quantile(tjd21, c(.025, .975)), 3)

mbd21 <- mboot_f2 - mboot_f1
mbd32 <- mboot_f3 - mboot_f2
mbd43 <- mboot_f4 - mboot_f3
mbd31 <- mboot_f3 - mboot_f1
mbd42 <- mboot_f4 - mboot_f2
mbd41 <- mboot_f4 - mboot_f1

mjd21 <- mjack_f2 - mjack_f1
mjd32 <- mjack_f3 - mjack_f2
mjd43 <- mjack_f4 - mjack_f3
mjd31 <- mjack_f3 - mjack_f1
mjd42 <- mjack_f4 - mjack_f2
mjd41 <- mjack_f4 - mjack_f1

CImbd21 <- round(quantile(mbd21, c(.025, .975)), 3)
CImjd21 <- round(quantile(mjd21, c(.025, .975)), 3)

dbd21 <- dboot_f2 - dboot_f1
dbd32 <- dboot_f3 - dboot_f2
dbd43 <- dboot_f4 - dboot_f3
dbd31 <- dboot_f3 - dboot_f1
dbd42 <- dboot_f4 - dboot_f2
dbd41 <- dboot_f4 - dboot_f1

djd21 <- djack_f2 - djack_f1
djd32 <- djack_f3 - djack_f2
djd43 <- djack_f4 - djack_f3
djd31 <- djack_f3 - djack_f1
djd42 <- djack_f4 - djack_f2
djd41 <- djack_f4 - djack_f1

CIdbd21 <- round(quantile(dbd21, c(.025, .975)), 3)
CIdjd21 <- round(quantile(djd21, c(.025, .975)), 3)

kbd21 <- kboot_f2 - kboot_f1
kbd32 <- kboot_f3 - kboot_f2
kbd43 <- kboot_f4 - kboot_f3
kbd31 <- kboot_f3 - kboot_f1
kbd42 <- kboot_f4 - kboot_f2
kbd41 <- kboot_f4 - kboot_f1

kjd21 <- kjack_f2 - kjack_f1
kjd32 <- kjack_f3 - kjack_f2
kjd43 <- kjack_f4 - kjack_f3
kjd31 <- kjack_f3 - kjack_f1
kjd42 <- kjack_f4 - kjack_f2
kjd41 <- kjack_f4 - kjack_f1

CIkbd21 <- round(quantile(kbd21, c(.025, .975)), 3)
CIkjd21 <- round(quantile(kjd21, c(.025, .975)), 3)

tf1 <- transitivity(fg1)
tf2 <- transitivity(fg2)
tf3 <- transitivity(fg3)
tf4 <- transitivity(fg4)

mf1 <- mean(degree(fg1))
mf2 <- mean(degree(fg2))
mf3 <- mean(degree(fg3))
mf4 <- mean(degree(fg4))

df1 <- edge_density(fg1)
df2 <- edge_density(fg2)
df3 <- edge_density(fg3)
df4 <- edge_density(fg4)

kf1 <- sum(coreness(fg1) > 1)
kf2 <- sum(coreness(fg2) > 1)
kf3 <- sum(coreness(fg3) > 1)
kf4 <- sum(coreness(fg4) > 1)

ptb21 <- paste("boot:", "[", paste(CItbd21[1], CItbd21[2], sep=", "), "]")
ptj21 <- paste("jack:", "[", paste(CItjd21[1], CItjd21[2], sep=", "), "]")
pmb21 <- paste("boot:", "[", paste(CImbd21[1], CImbd21[2], sep=", "), "]")
pmj21 <- paste("jack:", "[", paste(CImjd21[1], CImjd21[2], sep=", "), "]")
pdb21 <- paste("boot:", "[", paste(CIdbd21[1], CIdbd21[2], sep=", "), "]")
pdj21 <- paste("jack:", "[", paste(CIdjd21[1], CIdjd21[2], sep=", "), "]")
pkb21 <- paste("boot:", "[", paste(CIkbd21[1], CIkbd21[2], sep=", "), "]")
pkj21 <- paste("jack:", "[", paste(CIkjd21[1], CIkjd21[2], sep=", "), "]")
```

```{=latex}
\begin{center}
Time points 1 and 2
\end{center}

\begin{center}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
\textbf{Statistic} & \textbf{T1} & \textbf{T2} & \textbf{T2 - T1} & \textbf{95\% difference interval} & \textbf{95\% degseq} \\
\hline
Transitivity & `r round(tf1, 3)` & `r round(tf2, 3)` & `r round(tf2-tf1, 3)` & \makecell{`r ptb21` \\ `r ptj21`} & F \\
\hline
Mean Degree & `r round(mf1, 3)` & `r round(mf2, 3)` & `r round(mf2-mf1, 3)` & \makecell{`r pmb21` \\ `r pmj21`} & F \\
\hline
Edge Density & `r round(df1, 3)` & `r round(df2, 3)` & `r round(df2-df1, 3)` & \makecell{`r pdb21` \\ `r pdj21`} & F \\
\hline
Coreness, k > 1 & `r round(kf1, 3)` & `r round(kf2, 3)` & `r round(kf2-kf1, 3)` & \makecell{`r pkb21` \\ `r pkj21`} & F \\
\hline
\end{tabular}
\end{center}
```


<!-- | Statistic       | T1    | T2    | T2 - T1   | 95% C.I.                               | T1    | -->
<!-- |:----------------|:-----:|:-----:|:---------:|:--------------------------------------:|:-----:| -->
<!-- | Transitivity    |`r round(tf1, 3)`|`r round(tf2, 3)`|`r round(tf2-tf1, 3)`|`r cat(paste(ptb21, ptj21, sep = "\n"))`|       | -->
<!-- | Mean Degree     |`r round(mf1, 3)`|`r round(mf2, 3)`|`r round(mf2-mf1, 3)`|                                        |       | -->
<!-- | Edge Density    |`r round(df1, 3)`|`r round(df2, 3)`|`r round(df2-df1, 3)`|                                        |       | -->
<!-- | Coreness, k > 1 |`r round(kf1, 3)`|`r round(kf2, 3)`|`r round(kf2-kf1, 3)`|                                        |       | -->

## Mean Degree
```{r echo=FALSE}


mdd21 <- mdeg_f2 - mdeg_f1
mdd32 <- mdeg_f3 - mdeg_f2
mdd43 <- mdeg_f4 - mdeg_f3
mdd31 <- mdeg_f3 - mdeg_f1
mdd42 <- mdeg_f4 - mdeg_f2
mdd41 <- mdeg_f4 - mdeg_f1

fm <- matrix(NA, nrow = 6, ncol = 6)
rownames(fm) <- c('T2 - T1', 'T3 - T2', 'T4 - T3', 'T3 - T1', 'T4 - T2', 'T4 - T1')
colnames(fm) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

fm[1,] <- c(quantile(mbd21, c(.025, .975)), quantile(mjd21, c(.025, .975)), quantile(mdd21, c(.025, .975)))
fm[2,] <- c(quantile(mbd32, c(.025, .975)), quantile(mjd32, c(.025, .975)), quantile(mdd32, c(.025, .975)))
fm[3,] <- c(quantile(mbd43, c(.025, .975)), quantile(mjd43, c(.025, .975)), quantile(mdd43, c(.025, .975)))
fm[4,] <- c(quantile(mbd31, c(.025, .975)), quantile(mjd31, c(.025, .975)), quantile(mdd31, c(.025, .975)))
fm[5,] <- c(quantile(mbd42, c(.025, .975)), quantile(mjd42, c(.025, .975)), quantile(mdd42, c(.025, .975)))
fm[6,] <- c(quantile(mbd41, c(.025, .975)), quantile(mjd41, c(.025, .975)), quantile(mdd41, c(.025, .975)))

as.table(fm)
```

## Edge Density
```{r echo=FALSE}


ddd21 <- ddeg_f2 - ddeg_f1
ddd32 <- ddeg_f3 - ddeg_f2
ddd43 <- ddeg_f4 - ddeg_f3
ddd31 <- ddeg_f3 - ddeg_f1
ddd42 <- ddeg_f4 - ddeg_f2
ddd41 <- ddeg_f4 - ddeg_f1

fd <- matrix(NA, nrow = 6, ncol = 6)
rownames(fd) <- c('T2 - T1', 'T3 - T2', 'T4 - T3', 'T3 - T1', 'T4 - T2', 'T4 - T1')
colnames(fd) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

fd[1,] <- c(quantile(dbd21, c(.025, .975)), quantile(djd21, c(.025, .975)), quantile(ddd21, c(.025, .975)))
fd[2,] <- c(quantile(dbd32, c(.025, .975)), quantile(djd32, c(.025, .975)), quantile(ddd32, c(.025, .975)))
fd[3,] <- c(quantile(dbd43, c(.025, .975)), quantile(djd43, c(.025, .975)), quantile(ddd43, c(.025, .975)))
fd[4,] <- c(quantile(dbd31, c(.025, .975)), quantile(djd31, c(.025, .975)), quantile(ddd31, c(.025, .975)))
fd[5,] <- c(quantile(dbd42, c(.025, .975)), quantile(djd42, c(.025, .975)), quantile(ddd42, c(.025, .975)))
fd[6,] <- c(quantile(dbd41, c(.025, .975)), quantile(djd41, c(.025, .975)), quantile(ddd41, c(.025, .975)))

as.table(fd)
```

## Number of nodes in k-cores where k > 1
```{r echo=FALSE}


kdd21 <- kdeg_f2 - kdeg_f1
kdd32 <- kdeg_f3 - kdeg_f2
kdd43 <- kdeg_f4 - kdeg_f3
kdd31 <- kdeg_f3 - kdeg_f1
kdd42 <- kdeg_f4 - kdeg_f2
kdd41 <- kdeg_f4 - kdeg_f1

fk <- matrix(NA, nrow = 6, ncol = 6)
rownames(fk) <- c('T2 - T1', 'T3 - T2', 'T4 - T3', 'T3 - T1', 'T4 - T2', 'T4 - T1')
colnames(fk) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

fk[1,] <- c(quantile(kbd21, c(.025, .975)), quantile(kjd21, c(.025, .975)), quantile(kdd21, c(.025, .975)))
fk[2,] <- c(quantile(kbd32, c(.025, .975)), quantile(kjd32, c(.025, .975)), quantile(kdd32, c(.025, .975)))
fk[3,] <- c(quantile(kbd43, c(.025, .975)), quantile(kjd43, c(.025, .975)), quantile(kdd43, c(.025, .975)))
fk[4,] <- c(quantile(kbd31, c(.025, .975)), quantile(kjd31, c(.025, .975)), quantile(kdd31, c(.025, .975)))
fk[5,] <- c(quantile(kbd42, c(.025, .975)), quantile(kjd42, c(.025, .975)), quantile(kdd42, c(.025, .975)))
fk[6,] <- c(quantile(kbd41, c(.025, .975)), quantile(kjd41, c(.025, .975)), quantile(kdd41, c(.025, .975)))

as.table(fk)
```

# Tortoise Network

## Transitivity
```{r echo=FALSE}
tbd1 <- tboot_t98 - tboot_t97
tbd2 <- tboot_t99 - tboot_t98
tbd3 <- tboot_t99 - tboot_t97

tjd1 <- tjack_t98 - tjack_t97
tjd2 <- tjack_t99 - tjack_t98
tjd3 <- tjack_t99 - tjack_t97

tdd1 <- tdeg_tg98 - tdeg_tg97
tdd2 <- tdeg_tg99 - tdeg_tg98
tdd3 <- tdeg_tg99 - tdeg_tg97

tt <- matrix(NA, nrow = 3, ncol = 6)
rownames(tt) <- c('\'98 - \'97', '\'99 - \'98', '\'99 - \'97')
colnames(tt) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

tt[1,] <- c(quantile(tbd1, c(.025, .975)), quantile(tjd1, c(.025, .975)), quantile(tdd1, c(.025, .975)))
tt[2,] <- c(quantile(tbd2, c(.025, .975)), quantile(tjd2, c(.025, .975)), quantile(tdd2, c(.025, .975)))
tt[3,] <- c(quantile(tbd3, c(.025, .975)), quantile(tjd3, c(.025, .975)), quantile(tdd3, c(.025, .975)))

as.table(tt)
```

## Mean Degree
```{r echo=FALSE}
mbd1 <- mboot_t98 - mboot_t97
mbd2 <- mboot_t99 - mboot_t98
mbd3 <- mboot_t99 - mboot_t97

mjd1 <- mjack_t98 - mjack_t97
mjd2 <- mjack_t99 - mjack_t98
mjd3 <- mjack_t99 - mjack_t97

mdd1 <- mdeg_tg98 - mdeg_tg97
mdd2 <- mdeg_tg99 - mdeg_tg98
mdd3 <- mdeg_tg99 - mdeg_tg97

tm <- matrix(NA, nrow = 3, ncol = 6)
rownames(tm) <- c('\'98 - \'97', '\'99 - \'98', '\'99 - \'97')
colnames(tm) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

tm[1,] <- c(quantile(mbd1, c(.025, .975)), quantile(mjd1, c(.025, .975)), quantile(mdd1, c(.025, .975)))
tm[2,] <- c(quantile(mbd2, c(.025, .975)), quantile(mjd2, c(.025, .975)), quantile(mdd2, c(.025, .975)))
tm[3,] <- c(quantile(mbd3, c(.025, .975)), quantile(mjd3, c(.025, .975)), quantile(mdd3, c(.025, .975)))

as.table(tm)
```

## Edge Density
```{r echo=FALSE}
dbd1 <- dboot_t98 - dboot_t97
dbd2 <- dboot_t99 - dboot_t98
dbd3 <- dboot_t99 - dboot_t97

djd1 <- djack_t98 - djack_t97
djd2 <- djack_t99 - djack_t98
djd3 <- djack_t99 - djack_t97

ddd1 <- ddeg_tg98 - ddeg_tg97
ddd2 <- ddeg_tg99 - ddeg_tg98
ddd3 <- ddeg_tg99 - ddeg_tg97

td <- matrix(NA, nrow = 3, ncol = 6)
rownames(td) <- c('\'98 - \'97', '\'99 - \'98', '\'99 - \'97')
colnames(td) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

td[1,] <- c(quantile(dbd1, c(.025, .975)), quantile(djd1, c(.025, .975)), quantile(ddd1, c(.025, .975)))
td[2,] <- c(quantile(dbd2, c(.025, .975)), quantile(djd2, c(.025, .975)), quantile(ddd2, c(.025, .975)))
td[3,] <- c(quantile(dbd3, c(.025, .975)), quantile(djd3, c(.025, .975)), quantile(ddd3, c(.025, .975)))

as.table(td)
```

## Number of nodes in k-cores where k > 1
```{r echo=FALSE}
kbd1 <- kboot_t98 - kboot_t97
kbd2 <- kboot_t99 - kboot_t98
kbd3 <- kboot_t99 - kboot_t97

kjd1 <- kjack_t98 - kjack_t97
kjd2 <- kjack_t99 - kjack_t98
kjd3 <- kjack_t99 - kjack_t97

kdd1 <- kdeg_tg98 - kdeg_tg97
kdd2 <- kdeg_tg99 - kdeg_tg98
kdd3 <- kdeg_tg99 - kdeg_tg97

tk <- matrix(NA, nrow = 3, ncol = 6)
rownames(tk) <- c('\'98 - \'97', '\'99 - \'98', '\'99 - \'97')
colnames(tk) <- c('Boot 2.5%', 'Boot 97.5%', 'Jack 2.5%', 'Jack 97.5%', 'Degseq 2.5%', 'Degseq 97.5%')

tk[1,] <- c(quantile(kbd1, c(.025, .975)), quantile(kjd1, c(.025, .975)), quantile(kdd1, c(.025, .975)))
tk[2,] <- c(quantile(kbd2, c(.025, .975)), quantile(kjd2, c(.025, .975)), quantile(kdd2, c(.025, .975)))
tk[3,] <- c(quantile(kbd3, c(.025, .975)), quantile(kjd3, c(.025, .975)), quantile(kdd3, c(.025, .975)))

as.table(tk)
```